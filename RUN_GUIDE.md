# 齿轮磨损数据分析系统 - 运行指南

## 🚀 快速开始

### 方式一：使用 uv（推荐）⚡

[uv](https://docs.astral.sh/uv/) 是一个极快的Python包管理器，比pip快10-100倍。

```bash
# 1. 安装uv（如果尚未安装）
curl -LsSf https://astral.sh/uv/install.sh | sh

# 2. 同步依赖（自动创建虚拟环境）
uv sync

# 3. 运行应用
uv run streamlit run app.py
```

### 方式二：使用传统pip

```bash
# 1. 创建虚拟环境（可选但推荐）
python -m venv venv
source venv/bin/activate  # Linux/Mac
# venv\Scripts\activate  # Windows

# 2. 安装依赖
pip install -r requirements.txt

# 3. 运行应用
streamlit run app.py
```

应用将在浏览器中自动打开，默认地址: `http://localhost:8501`

## 📚 功能说明

### 数据浏览页面
- 查看原始振动信号波形
- 基础统计信息（均值、标准差、峰值等）
- 可选包络显示
- 支持时间范围选择

### 信号分析页面
提供三种分析模式：

**时域分析**
- 18种时域特征（RMS、峰值、峰度、波峰因子等）
- 形状特征分析
- 能量特征计算

**频域分析**
- FFT频谱图（带峰值标注）
- 频域特征（主频率、频谱质心、谐波比等）
- 功率谱密度分析

**时频分析**
- STFT声谱图
- 时频特性展示
- 可调窗长度

### 齿轮诊断页面
- 齿轮啮合频率（GMF）分析
- 谐波和边频带检测
- 自动故障诊断（正常/轻磨/中磨/重磨）
- 齿轮特征频谱（带GMF标注）
- 故障因子和磨损指标

### 特征对比页面
支持三种对比模式：
- **磨损状态对比**: 比较不同磨损程度的特征差异
- **传感器位置对比**: 比较不同传感器测量结果
- **工况参数对比**: 比较不同扭矩下的信号特性

## 🎯 使用流程

1. **选择数据**: 在侧边栏选择主动轮/从动轮状态、扭矩、传感器位置
2. **设置参数**: 调整时间范围、频率范围等分析参数
3. **查看结果**: 在主页面查看波形、分析结果和诊断信息
4. **对比分析**: 切换到对比页面进行多工况对比

## 📊 数据说明

### 磨损状态
- **正常**: 齿轮健康，无明显磨损
- **轻磨损**: 轻度磨损，表面有轻微痕迹
- **重磨损**: 重度磨损，表面磨损严重

### 传感器位置
- **传感器A**: 主动轴输入轴承处
- **传感器B**: 从动轴输入处
- **传感器C**: 从动轴输出处

### 测量方向
- **X轴**: 轴向
- **Y轴**: 径向
- **Z轴**: 径向

### 实验工况
- **扭矩**: 10 Nm, 15 Nm
- **转速**: 1000 rpm
- **采样率**: 15360 Hz
- **时长**: 30 秒

## 🔧 uv 包管理器使用指南

### 为什么使用 uv？

- **极速**: 比pip快10-100倍，使用Rust编写
- **可靠**: 精确的依赖解析，避免版本冲突
- **现代**: 原生支持`pyproject.toml`，符合PEP标准
- **隔离**: 自动管理虚拟环境

### 常用命令

```bash
# 同步依赖（安装所有依赖）
uv sync

# 只安装生产依赖（不含开发依赖）
uv sync --no-dev

# 添加新依赖
uv add numpy pandas

# 添加开发依赖
uv add --dev pytest black

# 移除依赖
uv remove package-name

# 更新依赖
uv lock --upgrade

# 在虚拟环境中运行命令
uv run python script.py
uv run streamlit run app.py

# 激活虚拟环境（可选）
source .venv/bin/activate  # Linux/Mac
.venv\Scripts\activate     # Windows
```

### 项目依赖管理

所有依赖都定义在 `pyproject.toml` 文件中：

- **生产依赖**: `[project.dependencies]`
- **开发依赖**: `[dependency-groups.dev]`

锁定的精确版本存储在 `uv.lock` 文件中，确保环境一致性。

## 🔧 高级功能

### 缓存机制
系统使用Streamlit的缓存装饰器（@st.cache_data）优化数据加载性能，相同数据不会重复加载。

### 参数调整
- **时间范围**: 0-30秒可调
- **频率范围**: 0-7500 Hz可调
- **STFT窗长**: 128/256/512/1024/2048可选

### 导出功能
图表支持Plotly内置的导出功能：
- 缩放/平移查看细节
- 下载为PNG图片
- 悬停查看数值

## 📁 项目结构

```
wear-datas/
├── app.py                 # 主应用
├── config/               # 配置模块
├── data/                 # 数据处理模块
├── processing/           # 信号处理模块
├── visualization/        # 可视化模块
├── ui/                   # UI组件
├── tests/                # 测试
└── *.csv                # 数据文件
```

## ⚠️ 注意事项

1. 首次运行会创建缓存目录（cache/）和日志目录（logs/）
2. 数据文件需要放在项目根目录
3. 建议使用Chrome/Firefox浏览器以获得最佳体验
4. 分析大时间范围数据时可能需要较长计算时间

## 🐛 常见问题

**Q: 数据加载失败**
A: 检查CSV文件是否在项目根目录，文件名格式是否正确

**Q: 图表显示异常**
A: 尝试刷新页面或清除浏览器缓存

**Q: 分析速度慢**
A: 减小时间范围或使用缓存功能

## 📞 技术支持

如有问题，请查看：
- 日志文件: `logs/app.log`
- 错误日志: `logs/error.log`

---

**开发**: 基于Claude Code实现
**版本**: v1.0
**最后更新**: 2024
